{
  "description": "Plan schema",
  "$id": "https://defy.org/plan",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9]+(?:_[a-z0-9]+)*$"
    },
    "name": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "type": {
      "enum": [
        "Base",
        "Multiple Distances",
        "Marathon",
        "Half Marathon",
        "5K",
        "10K",
        "15k/10m",
        "50K",
        "100K",
        "100M"
      ]
    },
    "units": {
      "enum": ["mi", "km"]
    },
    "source": {
      "type": "string"
    },
    "schedule": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/week"
      },
      "minItems": 1
    }
  },
  "required": [
    "id",
    "name",
    "description",
    "units",
    "source",
    "type",
    "schedule"
  ],
  "definitions": {
    "week": {
      "type": "object",
      "properties": {
        "description": { "type": "string" },
        "distance": { "type": "number" },
        "workouts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/workout"
          },
          "minItems": 7,
          "maxItems": 7
        }
      },
      "required": ["workouts"]
    },
    "workout": {
      "type": "object",
      "properties": {
        "title": { "type": "string" },
        "description": { "type": "string" },
        "distance": { "type": "number" },
        "tags": {
          "type": "array",
          "items": {
            "enum": [
              "Rest",
              "Easy Run",
              "Run",
              "Long Run",
              "Cross Train",
              "Race",
              "Speedwork",
              "Hills"
            ]
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "paces": {
          "type": "array",
          "description": "Structured pace information for different segments of the workout",
          "items": {
            "$ref": "#/definitions/paceSegment"
          }
        }
      },
      "required": ["title"]
    },
    "paceSegment": {
      "type": "object",
      "description": "A segment of the workout with a specific pace zone",
      "properties": {
        "zone": {
          "type": "string",
          "enum": [
            "recovery",
            "easy",
            "marathon",
            "threshold",
            "interval",
            "repetition"
          ],
          "description": "Universal pace zone that maps to provider-specific terminology"
        },
        "distance": {
          "type": "number",
          "description": "Distance for this pace segment (optional for intervals)"
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of this pace segment"
        },
        "intervals": {
          "type": "object",
          "description": "Interval-specific information",
          "properties": {
            "count": {
              "type": "integer",
              "minimum": 1,
              "description": "Number of intervals"
            },
            "distance": {
              "type": "number",
              "description": "Distance per interval"
            },
            "units": {
              "type": "string",
              "enum": ["m", "km", "mi", "yd"],
              "description": "Units for interval distance"
            },
            "recovery": {
              "type": "string",
              "description": "Recovery between intervals"
            }
          },
          "required": ["count", "distance"]
        }
      },
      "required": ["zone", "description"]
    }
  }
}
